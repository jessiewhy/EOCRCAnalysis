---
title: "Fitness"
author: "Jessie Huang"
date: "2024-04-08"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(fiftystater)
library(tidyr)
library(tidyverse)
library(dplyr)
library(ggplot2)
```

# Fitness 1
CDC Guidelines:
Adults (18-64 years): At least 150 minutes a week of moderate intensity activity such as brisk walking. At least 2 days a week of activities that strengthen muscles. Aim for the recommended activity level but be as active as you are able.

```{r}
data_physact <- read.csv('crc/physicalactivity.csv', check.names = FALSE)
head(data_physact)
```

```{r}
# EO-CRC rising in all races (especially White and Black) and males
demographics <- c('18-24', '25-34', '35-44', '45-54', 'Black, non-Hispanic', 'White, non-Hispanic', 'American Indian or Alaskan Native, non-Hispanic', 'Asian, non-Hispanic', 'Native Hawaiian or other Pacific Islander, non-Hispanic', 'Multiracial, non-Hispanic', 'Other, non-Hispanic', 'Hispanic', 'Female', 'Male')
race <- c('Black, non-Hispanic', 'White, non-Hispanic', 'American Indian or Alaskan Native, non-Hispanic', 'Asian, non-Hispanic', 'Native Hawaiian or other Pacific Islander, non-Hispanic', 'Multiracial, non-Hispanic', 'Other, non-Hispanic', 'Hispanic')
age <- c('18-24', '25-34', '35-44', '45-54')
sex <- c('Female', 'Male')
```

```{r}
# adults who meet cdc criteria for activity
data_physact_q1 <- data_physact %>% 
  filter(Question == 'Participated in enough Aerobic and Muscle Strengthening exercises to meet guidelines (variable calculated from one or more BRFSS questions)') %>%
  select(Year, Locationabbr, Locationdesc, Break_Out, Response, Data_value) %>% 
  replace(is.na(.), 0)
head(data_physact_q1)
```

```{r}
data("fifty_states")
colnames(fifty_states)[6] <- 'state_desc'
colnames(data_physact_q1)[1] <- 'Year'
colnames(data_physact_q1)[2] <- 'state_cd'
colnames(data_physact_q1)[3] <- 'state_desc'
colnames(data_physact_q1)[4] <- 'demographic'
colnames(data_physact_q1)[5] <- 'Response'
colnames(data_physact_q1)[6] <- 'CrudePrevalence'
head(data_physact_q1)

data_physact_q1$CrudePrevalence <- ifelse(data_physact_q1$CrudePrevalence!=0.0, data_physact_q1$CrudePrevalence/100, 0)
data_physact_q1$Year <- as.factor(data_physact_q1$Year)
data_physact_q1$state_cd <- as.factor(data_physact_q1$state_cd)
data_physact_q1$demographic <- as.factor(data_physact_q1$demographic)
data_physact_q1$Response <- as.factor(data_physact_q1$Response)
data_physact_q1$state_desc <- tolower(data_physact_q1$state_desc)
head(data_physact_q1)
```
# modeling 
i believe the skip years make it so the increments are not linear, hence to fit to a linear model, i filtered to the most recent year to observe the relationship between demographics and fitness. 

```{r}
data_physact_q1_2019 <- data_physact_q1 %>%
  filter(Year==2019)

data_physact_inactive <- data_physact_q1_2019 %>% 
  filter(demographic %in% demographics & Response == 'No') %>%
  replace(is.na(.), 0)
data_physact_inactive_age <- data_physact_inactive %>% 
  filter(demographic %in% age) %>%
  replace(is.na(.), 0)
data_physact_inactive_sex <- data_physact_inactive %>% 
  filter(demographic %in% sex) %>%
  replace(is.na(.), 0)
data_physact_inactive_race <- data_physact_inactive %>% 
  filter(demographic %in% race) %>%
  replace(is.na(.), 0)

head(data_physact_inactive_age)
```
```{r}
# all demos
mod.fit.inactive <- lm(CrudePrevalence ~ demographic, data=data_physact_inactive)
summary(mod.fit.inactive)
plot(mod.fit.inactive)
```

```{r}
# all age groups increasing in inactivity
mod.fit.inactive.age <- lm(CrudePrevalence ~ demographic, data=data_physact_inactive_age)
summary(mod.fit.inactive.age)
plot(mod.fit.inactive.age)
```



```{r}
# males more likely to abide to CDC guidelines for fitness
mod.fit.inactive.sex <- lm(CrudePrevalence ~ demographic, data=data_physact_inactive_sex)
summary(mod.fit.inactive.sex)
plot(mod.fit.inactive.sex)
```



```{r}
# more likely to abide to CDC guidelines for fitness: asian, pacific islander (i suspect lack of data for significant decrease), and other
# less likely to abide to CDC guidelines for fitness: american indian/alaskan native, black, hispanic, multiracial, white
mod.fit.inactive.race <- lm(CrudePrevalence ~ demographic, data=data_physact_inactive_race)
summary(mod.fit.inactive.race)
plot(mod.fit.inactive.race)
```

# Fitness 2
```{r}
data_npo <- read.csv('crc/nutrition-physicalactivity-obesity.csv', check.names = FALSE)
head(data_npo)

data_physact2 <- data_npo %>% filter(Class == 'Physical Activity')
head(data_physact2)
```

```{r}
# 2019 most recent data for activity questions
data_physact2_2019 <- data_physact2 %>% 
  filter(YearEnd == 2019) %>%
  select(LocationAbbr, LocationDesc, 'Age(years)', Gender, 'Race/Ethnicity', Question, Data_Value) %>%
  replace(is.na(.), 0)
head(data_physact2_2019)
```

```{r}
colnames(data_physact2_2019)[1] <- 'state_cd'
colnames(data_physact2_2019)[2] <- 'state_desc'
colnames(data_physact2_2019)[3] <- 'age_group'
colnames(data_physact2_2019)[4] <- 'sex'
colnames(data_physact2_2019)[5] <- 'race_ethnicity'
colnames(data_physact2_2019)[6] <- 'fitness_category'
colnames(data_physact2_2019)[7] <- 'percent'
data_physact2_2019$state_desc <- tolower(data_physact2_2019$state_desc)
head(data_physact2_2019)
```


```{r}
race2 <- c("2 or more races", "American Indian/Alaska Native", "Asian", "Hawaiian/Pacific Islander", "Hispanic", "Non-Hispanic Black", "Non-Hispanic White", "Other")
data_physact2_2019_inactive_race <- data_physact2_2019 %>% 
  filter(race_ethnicity %in% race2 & fitness_category == 'Percent of adults who engage in no leisure-time physical activity')

data_inactive_geo_race <- left_join(fifty_states,data_physact2_2019_inactive_race, by='state_desc')
data_inactive_geo_race <- data_inactive_geo_race %>% drop_na()
head(data_inactive_geo_race)
```


# From obesity analysis
Races: American Indian/Alaska Native, Black, non-Hispanic, Hispanic, Multiracial, non-Hispanic, White, non-Hispanic
risk_states <- c('OK', 'AL', 'VA', 'SD', 'WI', 'ME', 'WY', 'MS', 'WV', 'IN')
```{r}
ggplot() + 
  geom_polygon(data=data_inactive_geo_race, aes(x=long, y=lat, group = group, fill=percent), color='white') + 
  scale_size(name="") + 
  facet_wrap(race_ethnicity~.)+
  theme_void() +
  ggtitle('Inactive Adults - Race') + 
  labs(fill = 'Percent %')
```

