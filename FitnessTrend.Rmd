---
title: "NutritionTrend"
author: "Jessie Huang"
date: "2024-04-08"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(fiftystater)
library(tidyr)
library(tidyverse)
library(dplyr)
library(ggplot2)
```

Summary:
more likely to meet cdc guidelines of weekly activity: asian, pacific islander, other
less likely to meet cdc guidelines of weekly activity: black, hispanic, multiracial, and white
plot of inactivity by race

# fitness 1
```{r}
data_physact <- read.csv('crc/physicalactivity.csv', check.names = FALSE)
head(data_physact)
```

CDC Guidelines:
Adults (18-64 years): At least 150 minutes a week of moderate intensity activity such as brisk walking. At least 2 days a week of activities that strengthen muscles. Aim for the recommended activity level but be as active as you are able.
```{r}
unique(data_physact$Question)
unique(data_physact$Response)
```
# risk demo and states obtained from obesity
risk_demo <- c('Black, non-Hispanic', 'Hispanic', 'Multiracial, non-Hispanic', 'White, non-Hispanic')
risk_states <- c('OK', 'AL', 'VA', 'SD', 'WI', 'ME', 'WY', 'MS', 'WV', 'IN')

```{r}
# EO-CRC rising in all races (especially White and Black) and males
demographics <- c('18-24', '25-34', '35-44', '45-54', 'Black, non-Hispanic', 'White, non-Hispanic', 'American Indian or Alaskan Native, non-Hispanic', 'Asian, non-Hispanic', 'Native Hawaiian or other Pacific Islander, non-Hispanic', 'Multiracial, non-Hispanic', 'Other, non-Hispanic', 'Hispanic', 'Male')
age <- c('18-24', '25-34', '35-44', '45-54')
race <- c('Black, non-Hispanic', 'White, non-Hispanic', 'American Indian or Alaskan Native, non-Hispanic', 'Asian, non-Hispanic', 'Native Hawaiian or other Pacific Islander, non-Hispanic', 'Multiracial, non-Hispanic', 'Other, non-Hispanic', 'Hispanic')
sex <- c('Male')

# DC an interesting outlier
study_states <- c('DC')
```

```{r}
# 2019 most recent data available
data_physact_2019 <- data_physact %>% 
  filter(Question == 'Participated in enough Aerobic and Muscle Strengthening exercises to meet guidelines (variable calculated from one or more BRFSS questions)' &
           Year == 2019) %>%
  select(Locationabbr, Locationdesc, Break_Out, Response, Data_value) %>% 
  replace(is.na(.), 0)
head(data_physact_2019)
```

```{r}
data("fifty_states")
colnames(fifty_states)[6] <- 'state_desc'
colnames(data_physact_2019)[1] <- 'state_cd'
colnames(data_physact_2019)[2] <- 'state_desc'
colnames(data_physact_2019)[3] <- 'demographic'
colnames(data_physact_2019)[4] <- 'Response'
colnames(data_physact_2019)[5] <- 'CrudePrevalence'
data_physact_2019$state_desc <- tolower(data_physact_2019$state_desc)
head(data_physact_2019)
```
```{r, warning=FALSE}
data_physact_2019_no <- data_physact_2019 %>% 
  filter(demographic %in% demographics & Response == 'No') %>%
  replace(is.na(.), 0)

data_physact_2019_raceno <- data_physact_2019_no %>% 
  filter(demographic %in% race) %>%
  replace(is.na(.), 0)

data_physact_2019_yes <- data_physact_2019 %>% 
  filter(demographic %in% demographics & Response == 'Yes') %>%
  replace(is.na(.), 0)

data_physact_2019_raceyes <- data_physact_2019_yes %>% 
  filter(demographic %in% race) %>%
  replace(is.na(.), 0)
```

```{r}
# more likely to meet cdc guidelines of weekly activity: asian, pacific islander, other
# less likely to meet cdc guidelines of weekly activity: black, hispanic, multiracial, and white
mod.fit.no <- lm(CrudePrevalence ~ demographic, data=data_physact_2019_raceno)
summary(mod.fit.no)
```

# fitness 2
```{r}
data_npo <- read.csv('crc/nutrition-physicalactivity-obesity.csv', check.names = FALSE)
head(data_npo)

data_physact2 <- data_npo %>% filter(Class == 'Physical Activity')
head(data_physact2)
```

```{r}
unique(data_physact2$Question)
```

```{r}
# 2019 most recent data for activity questions
data_physact2_2019 <- data_physact2 %>% 
  filter(YearEnd == 2019) %>%
  select(LocationAbbr, LocationDesc, 'Age(years)', Gender, 'Race/Ethnicity', Question, Data_Value) %>%
  replace(is.na(.), 0)
head(data_physact2_2019)
```

```{r}
data("fifty_states")
colnames(fifty_states)[6] <- 'state_desc'
colnames(data_physact2_2019)[1] <- 'state_cd'
colnames(data_physact2_2019)[2] <- 'state_desc'
colnames(data_physact2_2019)[3] <- 'age_group'
colnames(data_physact2_2019)[4] <- 'sex'
colnames(data_physact2_2019)[5] <- 'race_ethnicity'
colnames(data_physact2_2019)[6] <- 'fitness_category'
colnames(data_physact2_2019)[7] <- 'percent'
head(data_physact2_2019)
```
```{r}
# only want under 50's
age2 <- c('18 - 24', '25 - 34', '35 - 44', '45 - 54')
race2 <- c("2 or more races", "American Indian/Alaska Native", "Asian", "Hawaiian/Pacific Islander", "Hispanic", "Non-Hispanic Black", "Non-Hispanic White", "Other")
sex2 <- c('Female','Male')
data_physact2_2019_filtered <- data_physact2_2019 %>% 
  filter(age_group %in% age2 | race_ethnicity %in% race2 | sex %in% sex2)
head(data_physact2_2019_filtered)
```

```{r}
data_physact2_2019_active <- data_physact2_2019_filtered %>% 
  filter(! fitness_category %in% 'Percent of adults who engage in no leisure-time physical activity')
data_physact2_2019_inactive <- data_physact2_2019_filtered %>% 
  filter(fitness_category %in% 'Percent of adults who engage in no leisure-time physical activity')
head(data_physact2_2019_active)
unique(data_physact2_2019_active$race_ethnicity)
```

```{r}
mod.fit.active <- lm(percent ~ age_group+sex+race_ethnicity+
                       age_group*sex+age_group*race_ethnicity+
                       sex*race_ethnicity
                       , data=data_physact2_2019_active)
mod.fit.active2 <- lm(percent ~ race_ethnicity
                       , data=data_physact2_2019_active)
summary(mod.fit.active)
summary(mod.fit.active2)
```

```{r}
mod.fit.inactive <- lm(percent ~ race_ethnicity, data=data_physact2_2019_inactive)
summary(mod.fit.inactive)
```

```{r}
# data_physact2_2019_filtered <- data_physact2_2019 %>% filter(age_group %in% age2 | race_ethnicity %in% race2 | sex %in% sex2)
data_physact2_2019_race <- data_physact2_2019 %>% 
  filter(race_ethnicity %in% race2)
data_physact2_2019_sex <- data_physact2_2019 %>% 
  filter(sex %in% sex2)
data_physact2_2019_age
```

```{r}
data_physact2_2019$state_desc <- tolower(data_physact2_2019$state_desc)
data_physact2_2019_inactive_age <- data_physact2_2019 %>% 
  filter(age_group %in% age2 & fitness_category == 'Percent of adults who engage in no leisure-time physical activity')
data_physact2_2019_inactive_age %>% 
  group_by(age_group, state_cd ) %>%
  arrange(desc(percent))

data_physact2_2019_inactive_sex <- data_physact2_2019 %>% 
  filter(sex %in% sex2 & fitness_category == 'Percent of adults who engage in no leisure-time physical activity')

data_physact2_2019_inactive_race <- data_physact2_2019 %>% 
  filter(race_ethnicity %in% race2 & fitness_category == 'Percent of adults who engage in no leisure-time physical activity')

data_inactive_geo_age <- left_join(fifty_states,data_physact2_2019_inactive_age, by='state_desc')
head(data_inactive_geo_age)

data_inactive_geo_sex <- left_join(fifty_states,data_physact2_2019_inactive_sex, by='state_desc') 
data_inactive_geo_sex <- data_inactive_geo_sex %>% drop_na()
head(data_inactive_geo_sex)

data_inactive_geo_race <- left_join(fifty_states,data_physact2_2019_inactive_race, by='state_desc')
data_inactive_geo_race <- data_inactive_geo_race %>% drop_na()
head(data_inactive_geo_race)
```

```{r}
ggplot() + 
  geom_polygon(data=data_inactive_geo_age, aes(x=long, y=lat, group = group, fill=percent), color='white') + 
  scale_size(name="", range = c(2, 5)) + 
  facet_wrap(age_group~.)+
  theme_void() +
  ggtitle('Inactive Adults - Age') + 
  labs(fill = 'Percent %')
```

```{r}
ggplot() + 
  geom_polygon(data=data_inactive_geo_sex, aes(x=long, y=lat, group = group, fill=percent), color='white') + 
  scale_size(name="") + 
  facet_wrap(sex~.)+
  theme_void() +
  ggtitle('Inactive Adults - Sex') + 
  labs(fill = 'Percent %')
```

# risk demo and states obtained from obesity
risk_demo <- c('Black, non-Hispanic', 'Hispanic', 'Multiracial, non-Hispanic', 'White, non-Hispanic')
risk_states <- c('OK', 'AL', 'VA', 'SD', 'WI', 'ME', 'WY', 'MS', 'WV', 'IN')

```{r}
ggplot() + 
  geom_polygon(data=data_inactive_geo_race, aes(x=long, y=lat, group = group, fill=percent), color='white') + 
  scale_size(name="") + 
  facet_wrap(race_ethnicity~.)+
  theme_void() +
  ggtitle('Inactive Adults - Race') + 
  labs(fill = 'Percent %')
```
